const hamburgerMenu=document.getElementById("hamburger-menu"),mobileNav=document.getElementById("mobile-nav"),mobileLinks=document.querySelectorAll(".mobile-link");hamburgerMenu.addEventListener("click",()=>mobileNav.classList.toggle("active")),mobileLinks.forEach(e=>e.addEventListener("click",()=>mobileNav.classList.remove("active")));function openWhatsApp(){const e="5516981205676",o=encodeURIComponent("Olá! Quero um orçamento para restauração de rodas.");window.open(`https://wa.me/${e}?text=${o}`,"_blank")}function scrollToEl(e){const o=document.querySelector(e);if(!o)return;const t=document.querySelector(".nav"),n=t?t.offsetHeight:0,a=o.getBoundingClientRect().top+window.pageYOffset-n-10;window.scrollTo({top:a,behavior:"smooth"})}document.querySelectorAll('a[href^="#"]').forEach(e=>e.addEventListener("click",function(o){const t=this.getAttribute("href");t&&t.startsWith("#")&&(o.preventDefault(),scrollToEl(t))})),document.getElementById("ano").textContent=(new Date).getFullYear();const form=document.getElementById("bookingForm"),dateInput=document.getElementById("data"),timeInput=document.getElementById("hora");function setMinDate(){const e=(new Date).toISOString().split("T")[0];dateInput.min=e}function updateTimeConstraintsForDate(e){if(Array.from(timeInput.childNodes).forEach(e=>timeInput.removeChild(e)),!e)return timeInput.disabled=!0,void dateInput.setCustomValidity("");const o=document.createElement("option");o.value="",o.textContent="Selecione o horário",timeInput.appendChild(o);let t=new Date(e+"T00:00:00"),n=t.getDay();if(0===n){let e;do{const o=new Date(t);o.setDate(o.getDate()+1),t=o,e=t.getDay()}while(0===e);const a=t.toISOString().split("T")[0];return dateInput.value=a,showFormFeedback(`Domingo indisponível — selecionado próximo dia útil: ${a}`),void updateTimeConstraintsForDate(a)}let a="08:00",d="18:00";6===n&&(d="12:00");const i=generateTimeSlots(a,d,30);if(0===i.length)return timeInput.disabled=!0,void showFormFeedback("Não há horários disponíveis para a data selecionada. Escolha outra data.");timeInput.disabled=!1,i.forEach(e=>{const t=document.createElement("option");t.value=e,t.textContent=e,timeInput.appendChild(t)})}function generateTimeSlots(e,o,t){const n=[],a=e=>e.split(":").map(Number).reduce((e,o)=>60*e+o),d=e=>{const o=String(Math.floor(e/60)).padStart(2,"0"),t=String(e%60).padStart(2,"0");return`${o}:${t}`},i=a(e),l=a(o);for(let e=i;e<=l;e+=t){if(e>l)break;n.push(d(e))}const c=Array.from(new Set(n));return c.sort((e,o)=>a(e)-a(o)),c}function showFormFeedback(e){const o=form.querySelector(".form-feedback");o&&o.remove();const t=document.createElement("div");t.className="form-feedback",t.textContent=e,t.style.color="#f0c",t.style.marginBlockStart="0.6rem",form.appendChild(t),setTimeout(()=>{t&&t.parentNode&&t.remove()},5e3)}dateInput.addEventListener("change",()=>{if(0===new Date(dateInput.value+"T00:00:00").getDay()){dateInput.setCustomValidity("Domingos não trabalhamos. Escolha outro dia."),timeInput.disabled=!0,Array.from(timeInput.childNodes).forEach(e=>timeInput.removeChild(e));const e=document.createElement("option");e.textContent="Selecione uma data válida primeiro",timeInput.appendChild(e),showFormFeedback("Domingos não trabalhamos. Escolha outro dia.")}else dateInput.setCustomValidity(""),updateTimeConstraintsForDate(dateInput.value)}),timeInput.addEventListener("change",()=>{timeInput.value?timeInput.setCustomValidity(""):timeInput.setCustomValidity("Por favor selecione um horário disponível.")}),setMinDate(),dateInput.value||(dateInput.value=dateInput.min),updateTimeConstraintsForDate(dateInput.value),form.addEventListener("submit",e=>{e.preventDefault();const o=dateInput.value;if(!o)return void dateInput.reportValidity();if(0===new Date(o+"T00:00:00").getDay())return dateInput.setCustomValidity("A empresa fecha aos domingos. Escolha outro dia."),void dateInput.reportValidity();dateInput.setCustomValidity("");const t=document.getElementById("hora").value;if(!t)return timeInput.setCustomValidity("Por favor selecione um horário disponível."),void timeInput.reportValidity();if(!timeInput.querySelector(`option[value="${t}"]`))return void showFormFeedback("Horário inválido. Selecione outro horário.");if(timeInput.setCustomValidity(""),!form.checkValidity())return void form.reportValidity();const n=document.getElementById("data").value,a=document.getElementById("hora").value,d=document.getElementById("nome").value.trim(),i=document.getElementById("servico").value,l=document.getElementById("whatsapp").value.trim(),c=document.getElementById("observacoes").value.trim(),s="5516981205676";let r=`Olá, equipe Monster — Refinamento Automotivo.

Gostaria de agendar uma visita e solicitar orçamento para o serviço selecionado. Seguem os dados:
`;r+=`• Serviço: ${i}
`,r+=`• Data: ${n}
`,r+=`• Horário desejado: ${a}
`,r+=`• Nome completo: ${d}
`,r+=`• WhatsApp do cliente: ${l}
`,c&&(r+=`• Observações: ${c}
`),r+="\nPor favor, confirmar a disponibilidade e enviar orçamento estimado, prazo e procedimentos iniciais.\n\nAgradeço — aguardo confirmação.";const m=encodeURIComponent(r),p=`https://wa.me/${s}?text=${m}`;window.open(p,"_blank");const u=document.createElement("div");u.textContent="Abrindo WhatsApp da empresa com os dados de agendamento...",u.style.color="#32CD32",u.style.fontWeight="bold",u.style.marginBlockStart="0.6rem";const g=form.querySelector(".form-feedback");g&&g.remove(),u.className="form-feedback",form.appendChild(u),setTimeout(()=>u.remove(),6e3)});const observerOptions={threshold:.1,rootMargin:"0px 0px -50px 0px"},observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.style.opacity="1",e.target.style.transform="translateY(0)")})},observerOptions);document.querySelectorAll(".services, .gallery, .booking, .contact").forEach(e=>{e.style.opacity="0",e.style.transform="translateY(30px)",e.style.transition="opacity 0.6s ease, transform 0.6s ease",observer.observe(e)})